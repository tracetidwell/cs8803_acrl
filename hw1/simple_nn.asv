function u = simple_nn(x, w)

input = 21;
d1 = 15;
d2 = 10;
output = 4;

idx1 = input * d1;
idx2= idx1 + d1 * d2;
idx3 = idx1 + idx2 + d2 * output;

w1 = reshape(w(1:idx1), input, d1);
w2 = reshape(w((idx1+1:idx2):1764), 42, 21);
w3 = reshape(w(1765:end), 21, 4);

a1 = sigmoid(w1.' * x);
a2 = sigmoid(w2.' * a1);
u = sigmoid(w3.' * a2);

end